Mulancha v2

Mulancha v2の概要

  ・マウス操作型プログラムランチャーです
      ・昔なんか公開していた奴の改良版です
  ・起動した時のマウス移動が少なくなる「パイ型」が特徴です

必要環境

  ・HSP3なんで、たぶんWindows 2000以上？

開発環境

  ・Win10 Home 2004 64bit
  ・HSP 3.51

起動方法

  ・mlc2.exeを実行すると、タスクトレイに入ります
  ・この状態で、マウスの右ボタンを押しながら左ボタンをクリックし、両者を離すと画面が起動します
      これを「ロッカージェスチャ」と呼びます。VivaldiやOtter Browserとは競合するよ
  ・タスクトレイのアイコンを左クリックすると終了させる事ができます

操作方法

  ・アイコンがある所(以降、アイテムと表記)をクリック
      それを起動します。
      デフォルトではIE、notepad、mspaintが入っています。
  ・アイテムを右クリック
      編集します。
  ・アイテム間でドラッグ&ドロップ
      アイテムを移動します。
  ・ファイルをドラッグ&ドロップ
      そのファイルを登録するものとして編集画面を起動します。
  ・何もない所をクリック
      新規項目を作成します。
  ・何もない所を右クリック
      タスクトレイに待避します。
  ・真ん中をクリック
      設定画面に移動します。
      サブメニューを開いている場合は、一つ上の階層に移動します。
  ・アクティブな状態でEscキー
      終了します。

編集方法

  ・以下の項目を入力して登録
      名前：識別できる名前を入力。ソフト名とか
      場所：起動したいファイルの場所を指定
      作業場所：実行形式のみの設定。実行ファイルの作業フォルダを指定
                指定がなければ実行ファイルが存在するフォルダが作業フォルダになる
      種別：登録するアイテムの種類を選択する
            実行形式    ：実行ファイルとか
            ファイル    ：実行ファイルじゃない奴全般
            フォルダー  ：フォルダー全般
            サブメニュー：クリックすると下にもう１個ランチャーが生成される奴
            管理者権限  ：regedit等、管理者権限で実行させたい実行ファイル
      Icon：表示するアイコンを指定
            画像指定は無理
      登録：アイテムを登録・既存アイテムを編集
      削除：既存アイテムを削除
            サブメニューを削除する際は、他のサブメニューから参照されてない事が条件です

設定画面

  ・起動方法
      起動するロッカージェスチャーを設定します。
      マウス左・右・中・拡張1・拡張2から組み合わせて設定します。
      それぞれ別のボタンではないと設定ができません。
  ・文字色
      文字の色(前景色)を設定します。
  ・背景色
      背景色を設定します。
  ・フォント
      フォントを設定します。フォント名以外にも項目がありますが、意味はないです。
      日本語等幅フォントを推奨します。
      標準はＭＳ ゴシックです。
  ・ファイラ
      フォルダーを開く時のアプリケーションを指定します。
      標準はexplorerです。

制限事項

  ・一つのパイは最大16分割
      増やしたければ適当にソースいじってください。
  ・名前、場所、作業場所、Iconは最大1024Byte(全角512文字)まで
  ・Unicode非対応
      HSP@Windowsの宿命。なんとかしたい人はCSharpにでも移植してください。
  ・UWPアプリ、ほぼ非対応
      アイテムに登録するだけならできます。例えば「start ms-settings:」と叩いてみてください。
      アイコンの取得は無理くさい。

TIPS

  ・UWPアプリを登録したい
      面倒臭いですが方法があります。以下Windows 10の場合です。
      エクスプローラーを開き、「shell:AppsFolder」を叩く
      登録したいUWPアプリを右クリック＞ショートカットの作成
      これを登録したいサブメニューにドラッグ&ドロップ
      ショートカットの矢印アイコンが表示されるのはご愛敬
      あとは「名前」を適当に設定して登録
  ・URIスキーマをアイテムに登録したい
      「場所」URIスキーマを入力 ms-settings: とか
      「Icon」諦めてそれっぽいのを頑張って探す
      「種別」ファイル
              実行形式だと処理の関係上エラーになります

作者

  ・私はm-ushiです。 https://munet.x0.to/

ソースコードについて

  ・mlc2.hspの頭に引用サイト入れてます。
    そのため、オープンライセンスとしての公開は無理そうですが、
    悪意のない限りで再利用したいならどうぞ。

更新履歴

  ・v2β3
      ・root.datを消せる(再インストールが必要になる)のを防ぐ
      ・設定で起動方法を変更しても保存されない
      ・設定画面の整理
      ・その他軽微な修正
  ・v2β2
      ・HSP3.5からHSP3.51に変更
      ・多重起動を防止
      ・半角空白パスを取得する処理に不具合(例えばC:\Program Files)
      ・その他軽微な修正
  ・v2β1(Twitterでチラ見せした時から何が変わったか)
      ・エクスプローラ等からD&Dの受付
      ・アイテムの並べ替え、削除
      ・exe/dll等のアイコンを複数保有しているやつ(正式名称なんてーの？)の選択
      ・作業フォルダの指定
      ・設定画面の実装
          ・起動するロッカージェスチャのカスタマイズ
          ・フォルダを開く場合のファイラーのカスタマイズ
          ・フォントの指定
          ・前景色と背景色の指定
      ・中間BMPファイルの導入による処理の高速化
  ・v1時代
      ・覚えてない

現状の課題

  ・ロッカージェスチャするとき、その時のアクティブウィンドウのクリックイベントを取ってしまう
      ・無理？他の方法を考えるしかない？
  ・エラートラップを一切していない
  ・サブメニュー間のアイテム移動も実装したいな
  ・なんか思いついたら追記

実装するつもりがないこと

  ・スタートアップへの登録
      ・ショートカット作るだけなら簡単だろうけど、削除が面倒